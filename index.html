<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Thoughts In Silico</title>
  <link rel="stylesheet" href="css/style.css" />
  <meta name="theme-color" content="#000000" />
  <script>
    window.MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$','$$'], ['\\[','\\]']] } };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body class="home">
  <header class="site-header container">
    <a class="site-title" href="index.html">Thoughts In Silico</a>
    <nav class="site-nav" aria-label="Primary">
      <a href="about.html">About</a>
      <a href="categories.html?cat=Book%20Reviews">Book Reviews</a>
      <div class="nav-dropdown">
        <a href="categories.html?cat=Fiction">Fiction ▾</a>
        <div class="nav-submenu nav-submenu--row">
          <a href="categories.html?cat=Fiction&sub=Short%20Stories">Short Stories</a>
          <a href="categories.html?cat=Fiction&sub=Poetry">Poetry</a>
        </div>
      </div>
      <a href="categories.html?cat=Mathematics">Mathematics</a>
      <a href="categories.html?cat=Technology">Technology</a>
      <a href="categories.html?cat=Music">Music</a>
      <a href="categories.html?cat=Miscellaneous">Miscellaneous</a>
    </nav>
  </header>

  <!-- Scroll hint: paper airplane + dotted curve (curved, opaque, smoother) -->
  <button class="scroll-hint" id="scrollHint" aria-label="Scroll to recent posts">
    <svg viewBox="0 0 64 64" width="36" height="36" aria-hidden="true">
      <!-- crisp paper airplane -->
      <path d="M4 30L60 6 28 36" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linejoin="round"/>
      <path d="M28 36l4 20 6-14 22-36" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linejoin="round"/>
    </svg>
  </button>
  <svg class="scroll-trace" viewBox="0 0 120 420" width="120" height="420" aria-hidden="true">
    <!-- You can tweak this curve anytime -->
    <path d="M10 10 C 70 80, 30 240, 20 360" />
  </svg>

  <!-- POSTS SECTION (starts one full viewport below; CSS sets margin-top:100vh) -->
  <main class="container home-posts">
    <h2 class="list-heading">Recent posts</h2>
    <div id="posts-grid" class="posts-grid" aria-live="polite"></div>

    <!-- Fully solid personal boxes BELOW the posts (you fill them) -->
    <section class="home-features" aria-label="Personal updates">
      <article class="feature-card">
        <h3 class="feature-title">Quote of the week</h3>
        <blockquote class="feature-quote"></blockquote>
      </article>

      <article class="feature-card">
        <h3 class="feature-title">What I’m up to</h3>
        <div class="feature-body"></div>
      </article>
    </section>
  </main>

  <footer class="site-footer container">
    <p><small>© 2025 Thoughts In Silico.</small></p>
  </footer>

  <!-- Typewriter for the site title (header layout is fixed in CSS; no shifting) -->
  <script>
    (function(){
      const el = document.querySelector('.site-title');
      const txt = el.textContent.trim();
      el.textContent = "";
      el.classList.add('typer');
      let i=0; const id=setInterval(()=>{
        el.textContent = txt.slice(0, ++i);
        if(i>=txt.length){ clearInterval(id); el.classList.add('caret-done'); }
      }, 55);
    })();
  </script>

  <!-- Render posts (newest first) -->
  <script>
    (async function renderHome(){
      const grid = document.getElementById('posts-grid');
      try{
        const res = await fetch('posts/posts.json');
        let posts = await res.json();
        posts = posts.sort((a,b)=> new Date(b.date) - new Date(a.date));
        grid.innerHTML = posts.map(p => `
          <article class="post-card reveal-card">
            <h3 class="post-title"><a href="${p.url}">${p.titleHtml || p.title}</a></h3>
            <time class="post-time" datetime="${p.date}">${new Date(p.date).toLocaleString(undefined,{month:'short',year:'numeric'})}</time>
            <p class="post-meta">${p.category}${p.subcategory ? ' • ' + p.subcategory : ''}</p>
          </article>
        `).join('');
        if (window.MathJax?.typeset) MathJax.typeset();
      }catch(e){
        console.error(e);
        grid.innerHTML = '<p class="muted">Could not load posts.</p>';
      }
    })();
  </script>

  <!-- Fade/slide in on scroll + airplane/trace interactions -->
  <script>
    (function(){
      // Reveal posts on scroll
      const obs = new IntersectionObserver((ents)=>{
        ents.forEach(e=>{
          if(e.isIntersecting){ e.target.classList.add('is-visible'); obs.unobserve(e.target); }
        });
      }, {threshold:0.12});
      const start = ()=> document.querySelectorAll('.reveal-card').forEach(el=>obs.observe(el));
      const mo = new MutationObserver(start);
      mo.observe(document.getElementById('posts-grid'), {childList:true});
      start();

      // Airplane & dotted trace behavior
      const btn = document.getElementById('scrollHint');
      const trace = document.querySelector('.scroll-trace');
      const posts = document.querySelector('.home-posts');
      if(!btn || !trace || !posts) return;

      const hide = () => { btn.classList.add('is-hidden'); trace.classList.add('is-hidden'); };
      let hidden = false;

      btn.addEventListener('click', () => posts.scrollIntoView({ behavior: 'smooth', block: 'start' }));

      // Hide if user starts scrolling a bit
      window.addEventListener('scroll', () => {
        if (!hidden && window.scrollY > window.innerHeight * 0.12) { hidden = true; hide(); }
      }, { passive: true });

      // Hide after animations complete
      btn.addEventListener('animationend', hide, { once: true });
      trace.addEventListener('animationend', hide, { once: true });
    })();
  </script>


  <script>
    /* === Fluid looping paper airplane — injects itself on any page === */
    (function(){
      // 1) Create elements
      const plane = document.createElement('div');
      plane.className = 'flight-hint';
      plane.innerHTML = `
        <svg viewBox="0 0 64 64" aria-hidden="true">
          <!-- solid, crisp paper airplane -->
          <path d="M4 30L60 6 28 36" fill="none" stroke="currentColor" stroke-width="2.6" stroke-linejoin="round"/>
          <path d="M28 36l4 20 6-14 22-36" fill="none" stroke="currentColor" stroke-width="2.6" stroke-linejoin="round"/>
        </svg>`;
    
      const trace = document.createElement('div');
      trace.className = 'flight-trace';
      trace.innerHTML = `
        <svg viewBox="0 0 1000 1600" preserveAspectRatio="none" aria-hidden="true">
          <path id="tsiFlightPath"
                d="M 80 100
                   C 360 40, 180 300, 120 420
                   c 80 -40, 160 -80, 210 -20
                   c 60 70, -100 130, -160 170
                   c 150 -40, 260 80, 180 140
                   c -60 46, -120 62, -180 110
                   c 140 -20, 260 60, 220 130
                   c -40 70, -160 110, -220 150
                   c 180 -30, 300 120, 260 180
                   c -40 60, -160 100, -240 150" />
        </svg>`;
    
      document.body.appendChild(plane);
      document.body.appendChild(trace);
    
      // 2) Tie CSS motion path to this path (so plane follows the same curve)
      const path = trace.querySelector('#tsiFlightPath');
      const d = path.getAttribute('d');
      document.documentElement.style.setProperty('--flight-path', `path("${d}")`);
    
      // 3) Place plane at start of path
      plane.style.offsetDistance = '0%';
    
      // 4) Pause/Resume when tab visibility changes (saves battery)
      document.addEventListener('visibilitychange', () => {
        const paused = document.hidden ? 'paused' : 'running';
        plane.style.animationPlayState = paused;
        trace.querySelector('path').style.animationPlayState = paused;
      });
    
      // 5) Fade away only when user reaches near bottom
      const thresh = 60; // px from bottom
      const onScroll = () => {
        const atBottom = window.innerHeight + window.scrollY >= (document.documentElement.scrollHeight - thresh);
        document.body.classList.toggle('flight-done', atBottom);
      };
      window.addEventListener('scroll', onScroll, {passive:true});
      onScroll();
    
      // Optional: click plane to nudge downward a screen
      plane.addEventListener('click', () => window.scrollBy({top: window.innerHeight * 0.9, behavior: 'smooth'}));
    })();
    </script>


  
</body>
</html>
