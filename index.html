<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Thoughts In Silico</title>
  <link rel="stylesheet" href="css/style.css" />
  <meta name="theme-color" content="#000000" />
  <script>
    window.MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$','$$'], ['\\[','\\]']] } };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body class="home">
  <div class="layout">
    <!-- ===== Sidebar (replaces top navbar) ===== -->
    <aside class="sidebar" role="navigation" aria-label="Primary">
      <div class="brand">
        <div class="sig">◇</div>
        <a class="site-title" href="index.html" style="color:inherit;text-decoration:none;">Thoughts In Silico</a>
      </div>

      <nav>
        <h3>Pages</h3>
        <ul>
          <li><a href="categories.html?cat=Book%20Reviews">Book Reviews</a></li>
          <li>
            <a href="categories.html?cat=Fiction">Fiction ▾</a>
            <ul style="margin:.25rem 0 .5rem 12px; padding:0; list-style:none;">
              <li><a href="categories.html?cat=Fiction&sub=Short%20Stories">Short Stories</a></li>
              <li><a href="categories.html?cat=Fiction&sub=Poetry">Poetry</a></li>
            </ul>
          </li>
          <li><a href="categories.html?cat=Mathematics">Mathematics</a></li>
          <li><a href="categories.html?cat=Technology">Technology</a></li>
          <li><a href="categories.html?cat=Music">Music</a></li>
          <li><a href="categories.html?cat=Miscellaneous">Miscellaneous</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="library.html">My Library</a></li>
        </ul>

        <h3>Anthems</h3>
        <article class="anthem-card" id="anthems">
          <div class="anthems-list" id="anthems-list"></div>
          <audio id="anthem-audio" preload="none"></audio>
        </article>
      </nav>
    </aside>

    <!-- ===== Main ===== -->
    <main class="main">
      <!-- Background art showcase; no wording added -->
      <section class="hero" aria-label="Background art"></section>

      <!-- Posts + features (wording preserved) -->
      <section class="container section">
        <h2 class="list-heading">Recent posts</h2>
        <div id="posts-grid" class="posts-grid" aria-live="polite"></div>

        <section class="section" aria-label="Personal updates" style="padding-top:10px">
          <article class="feature-card">
            <h3 class="feature-title">Quote of the week</h3>
            <blockquote class="feature-quote"></blockquote>
          </article>

          <article class="feature-card" style="margin-top:12px">
            <h3 class="feature-title">What I’m up to</h3>
            <div class="feature-body"></div>
          </article>
        </section>
      </section>

      <footer class="container" style="padding:18px 0 30px">
        <p><small>© 2025 Thoughts In Silico.</small></p>
      </footer>
    </main>
  </div>

  <!-- Keep your existing JS exactly (IDs preserved) -->
  <script>
    // Typewriter for site title (unchanged)
    (function(){
      const el = document.querySelector('.site-title');
      const txt = el.textContent.trim();
      el.textContent = "";
      el.classList.add('typer');
      let i=0;
      const id=setInterval(()=>{
        el.textContent = txt.slice(0, ++i);
        if(i>=txt.length){ clearInterval(id); el.classList.add('caret-done'); }
      }, 55);
    })();
  </script>

  <script>
    // Robust posts.json loader (unchanged logic)
    async function loadPostsJSON(){
      const candidates = ['posts.json', 'posts/posts.json'];
      let lastErr;
      for(const path of candidates){
        try{
          const res = await fetch(path, {cache:'no-store'});
          if(!res.ok) throw new Error(`${res.status} ${res.statusText}`);
          return await res.json();
        }catch(e){ lastErr = e; }
      }
      throw lastErr;
    }

    (async function(){
      const grid = document.getElementById('posts-grid');
      try{
        let posts = await loadPostsJSON();
        posts = posts.sort((a,b)=> new Date(b.date) - new Date(a.date));
        grid.innerHTML = posts.map(p => `
          <article class="post-card">
            <h3 class="post-title"><a href="${p.url}">${p.titleHtml || p.title}</a></h3>
            <time class="post-time" datetime="${p.date}">
              ${new Date(p.date).toLocaleString(undefined,{month:'short',year:'numeric'})}
            </time>
            <p class="post-meta">${p.category}${p.subcategory ? ' • ' + p.subcategory : ''}</p>
          </article>
        `).join('');
        if (window.MathJax?.typeset) MathJax.typeset();
      } catch (e) {
        console.error('Failed to load posts.json:', e);
        grid.innerHTML = '<p class="muted">Could not load posts.</p>';
      }
    })();
  </script>

  <!-- Your anthems logic from home (unchanged; same IDs) -->
  <script>
    (function(){
      const ANTHEMS = [
        { title: "Allegra (solo sketch)",  src: "audio/anthem1.mp3" },
        { title: "Third Stream Study in D",src: "audio/anthem2.mp3" },
        { title: "Nocturne for Two Tenors",src: "audio/anthem3.mp3" }
      ];
      const list  = document.getElementById('anthems-list');
      const audio = document.getElementById('anthem-audio');
      list.innerHTML = ANTHEMS.map((a,i)=>`
        <div class="anthem-item" data-i="${i}">
          <button class="anthem-btn" type="button">Play me</button>
          <span class="anthem-title" aria-live="polite">${a.title}</span>
        </div>
      `).join('');
      list.addEventListener('click', e=>{
        const btn = e.target.closest('.anthem-btn'); if(!btn) return;
        const i = +btn.parentElement.dataset.i;
        audio.src = ANTHEMS[i].src; audio.play();
      });
    })();
  </script>
</body>
</html>
