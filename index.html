<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Thoughts In Silico</title>
  <link rel="stylesheet" href="css/style.css" />
  <meta name="theme-color" content="#000000" />
  <script>
    window.MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$','$$'], ['\\[','\\]']] } };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body class="home">
  <header class="site-header container">
    <a class="site-title" href="index.html">Thoughts In Silico</a>
    <nav class="site-nav" aria-label="Primary">
      <a href="about.html">About</a>
      <a href="categories.html?cat=Book%20Reviews">Book Reviews</a>
      <div class="nav-dropdown">
        <a href="categories.html?cat=Fiction">Fiction ▾</a>
        <div class="nav-submenu nav-submenu--row">
          <a href="categories.html?cat=Fiction&sub=Short%20Stories">Short Stories</a>
          <a href="categories.html?cat=Fiction&sub=Poetry">Poetry</a>
        </div>
      </div>
      <a href="categories.html?cat=Mathematics">Mathematics</a>
      <a href="categories.html?cat=Technology">Technology</a>
      <a href="categories.html?cat=Music">Music</a>
      <a href="categories.html?cat=Miscellaneous">Miscellaneous</a>
    </nav>
  </header>

  <!-- ONE airy SVG overlay: plane + dotted trail -->
  <div class="flight-layer" aria-hidden="true">
    <svg class="flight-svg" viewBox="0 0 1000 1700" preserveAspectRatio="none">
      <defs>
        <!-- Smooth, airy curve with a small loop then a slide downward -->
        <path id="flightPath" d="
          M 820 80
          C 640 60, 720 160, 520 180
          C 420 190, 520 260, 700 300
          C 860 336, 870 380, 760 430
          C 640 486, 560 480, 600 560
          C 640 640, 780 670, 880 620
          C 960 580, 900 520, 820 520
          C 690 520, 610 620, 560 700
          C 500 800, 520 900, 600 980
          C 700 1080, 760 1120, 860 1200
          C 900 1230, 880 1320, 800 1370
          C 660 1450, 500 1460, 420 1530" />
      </defs>

      <!-- dotted trace that draws AFTER the plane (synced with motion) -->
      <use href="#flightPath"
           class="flight-trace-path"
           stroke="#f3f6ff" stroke-width="2" stroke-linecap="round"
           fill="none" stroke-dasharray="0 9" stroke-dashoffset="1200">
        <animate attributeName="stroke-dashoffset"
                 from="1200" to="0"
                 dur="18s" begin="0s" fill="freeze"
                 calcMode="spline" keySplines=".22 .61 .36 1"
                 repeatCount="indefinite"/>
      </use>

      <!-- the plane (solid, milky, slightly larger) -->
      <g id="plane" stroke="#f3f6ff" fill="none" stroke-width="2.8" stroke-linejoin="round">
        <path d="M4 30L60 6 28 36"/>
        <path d="M28 36l4 20 6-14 22-36"/>
        <animateMotion dur="18s" rotate="auto" repeatCount="indefinite"
                       calcMode="spline" keySplines=".22 .61 .36 1">
          <mpath href="#flightPath"/>
        </animateMotion>
      </g>
    </svg>
  </div>

  <!-- POSTS (start one full viewport down; see CSS margin-top: 100vh) -->
  <main class="container home-posts">
    <h2 class="list-heading">Recent posts</h2>
    <div id="posts-grid" class="posts-grid" aria-live="polite"></div>

    <!-- Solid, larger personal boxes (you fill them) -->
    <section class="home-features" aria-label="Personal updates">
      <article class="feature-card">
        <h3 class="feature-title">Quote of the week</h3>
        <blockquote class="feature-quote"></blockquote>
      </article>

      <article class="feature-card">
        <h3 class="feature-title">What I’m up to</h3>
        <div class="feature-body"></div>
      </article>
    </section>
  </main>

  <footer class="site-footer container">
    <p><small>© 2025 Thoughts In Silico.</small></p>
  </footer>

  <!-- Typewriter for the site title (layout is fixed; no shifting) -->
  <script>
    (function(){
      const el = document.querySelector('.site-title');
      const txt = el.textContent.trim();
      el.textContent = "";
      el.classList.add('typer');
      let i=0; const id=setInterval(()=>{
        el.textContent = txt.slice(0, ++i);
        if(i>=txt.length){ clearInterval(id); el.classList.add('caret-done'); }
      }, 55);
    })();
  </script>

  <!-- Render posts (newest first) -->
  <script>
    (async function(){
      const grid = document.getElementById('posts-grid');
      try{
        const res = await fetch('posts/posts.json');
        let posts = await res.json();
        posts = posts.sort((a,b)=> new Date(b.date) - new Date(a.date));
        grid.innerHTML = posts.map(p => `
          <article class="post-card reveal-card">
            <h3 class="post-title"><a href="${p.url}">${p.titleHtml || p.title}</a></h3>
            <time class="post-time" datetime="${p.date}">${new Date(p.date).toLocaleString(undefined,{month:'short',year:'numeric'})}</time>
            <p class="post-meta">${p.category}${p.subcategory ? ' • ' + p.subcategory : ''}</p>
          </article>
        `).join('');
        if (window.MathJax?.typeset) MathJax.typeset();
      }catch(e){
        console.error(e);
        grid.innerHTML = '<p class="muted">Could not load posts.</p>';
      }
    })();
  </script>

  <!-- Fade/slide in on scroll + fade plane away at page bottom -->
  <script>
    (function(){
      // Reveal cards when they enter
      const obs = new IntersectionObserver((es)=>es.forEach(e=>{
        if(e.isIntersecting){ e.target.classList.add('is-visible'); obs.unobserve(e.target); }
      }),{threshold:0.12});
      const start = ()=> document.querySelectorAll('.reveal-card').forEach(el=>obs.observe(el));
      const mo = new MutationObserver(start);
      mo.observe(document.getElementById('posts-grid'), {childList:true});
      start();

      // Fade out the whole SVG overlay near the bottom
      const layer = document.querySelector('.flight-layer');
      const thresh = 60;
      const onScroll = () => {
        const atBottom = window.innerHeight + window.scrollY >= (document.documentElement.scrollHeight - thresh);
        layer.style.opacity = atBottom ? 0 : 1;
        layer.style.transition = 'opacity .7s ease';
      };
      window.addEventListener('scroll', onScroll, {passive:true});
      onScroll();
    })();
  </script>
</body>
</html>
