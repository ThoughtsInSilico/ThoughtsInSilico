<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Thoughts In Silico</title>
  <link rel="stylesheet" href="css/style.css?v=2" />
  <meta name="theme-color" content="#0d1220" />
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <!-- MathJax for any math in titles -->
  <script>
    window.MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] } };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body>
  <!-- Header -->
  <header class="site-header">
    <a class="site-title" href="index.html">Thoughts In Silico</a>
    <nav class="site-nav" aria-label="Primary">
      <a href="index.html">Home</a>

      <div class="nav-dropdown">
        <a href="categories.html?cat=Fiction">Fiction ▾</a>
        <div class="nav-submenu nav-submenu--row">
          <a href="categories.html?cat=Fiction&sub=Short%20Stories">Short Stories</a>
          <a href="categories.html?cat=Fiction&sub=Poetry">Poetry</a>
        </div>
      </div>

      <a href="categories.html?cat=Book%20Reviews">Book Reviews</a>
      <a href="categories.html?cat=Mathematics">Mathematics</a>
    </nav>
  </header>

  <!-- Banner -->
  <div class="site-banner">
    <picture>
      <source srcset="img/banner.avif" type="image/avif">
      <source srcset="img/banner.webp" type="image/webp">
      <img src="img/banner.jpg" alt="Thoughts In Silico banner"
           width="1600" height="360" loading="eager" decoding="async">
    </picture>
  </div>

  <main class="container">
    <section class="hero">
      <p>Hi, it's Reza. Call this a quiet place to share my thoughts to those who listen.</p>
    </section>

    <h2 class="list-heading">Newest posts</h2>
    <section id="post-list" class="post-list"></section>
  </main>

  <footer class="site-footer">
    <p>May the light be with you.</p>
    <small>© <span id="y"></span> Thoughts In Silico</small>
  </footer>

  <script>
    // Footer year
    document.getElementById('y').textContent = new Date().getFullYear();

    // Render post list
    async function renderHome() {
      const list = document.getElementById('post-list');
      try {
        const res = await fetch('posts/posts.json');
        const posts = await res.json();

        posts.sort((a,b) => new Date(b.date) - new Date(a.date));
        const fmt = d => new Date(d).toLocaleString(undefined, { month:'long', year:'numeric' });

        list.innerHTML = posts.map(p => `
          <article class="post-card">
            <h2><a href="${p.url}">${p.titleHtml || p.title}</a></h2>
            <time datetime="${p.date.slice(0,7)}">${fmt(p.date)}</time>
            <p class="meta-line">
              ${p.category}${p.subcategory ? ' • ' + p.subcategory : ''}
            </p>
          </article>
        `).join('');

        if (window.MathJax?.typeset) MathJax.typeset();
      } catch (e) {
        console.error(e);
        list.innerHTML = '<p class="muted">Could not load posts.</p>';
      }
    }
    renderHome();
  </script>
</body>
</html>
