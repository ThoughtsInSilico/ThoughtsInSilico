<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Silico: Book of Genesis</title>
  <link rel="stylesheet" href="css/style.css" />
  <meta name="theme-color" content="#000000" />
  <script>
    window.MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$','$$'], ['\\[','\\]']] } };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script src="js/includes.js" defer></script>
</head>

<body class="home">
  <div class="layout">
    <!-- Sidebar include -->
    <div id="sidebar-include" data-src="partials/sidebar.html"></div>

    <main class="main">
      <section class="hero" aria-label="Background art"></section>

      <section class="container section">
        <h1 class="site-title" style="font-size: clamp(28px,5vw,46px);">Recent Posts</h1>
        <hr class="hr-dots"/>
        <div id="posts-grid" class="posts-grid" aria-live="polite"></div>
        
                <!-- ===== Interlude (between Recent Posts and Trvthnukes) ===== -->
        <section class="interlude" id="interlude">
          <div class="interlude-grid">
            <!-- LEFT: upward old-web tabs -->
            <aside class="left-rail">
              <div class="tab-stack" id="leftTabs"></div>
            </aside>        
            <!-- CENTER: still/moving media stays put while you scroll -->
            <div class="center-wrap">
              <!-- EDIT: replace src with your own image / GIF; or swap to a <video> (see script comment) -->
              <img class="center-media" id="centerMedia"
                   src="img/scroll-center.jpg"
                   alt="Center media">
            </div>        
            <!-- RIGHT: straight vertical line of Loading going downward -->
            <aside class="right-rail">
              <div class="loading-stack" id="rightLoading"></div>
            </aside>        
          </div>
        </section>
        <!-- ===== End Interlude ===== -->


        <article class="feature-card" style="margin-top:16px">
          <h3 class="roman" style="margin:0 0 6px">Trvthnukes</h3>
          <hr class="hr-dots" />
          <blockquote id="trvthnuke" class="post-body" style="margin:0"></blockquote>
        </article>

        <article class="feature-card" style="margin-top:12px">
          <h3 class="roman" style="margin:0 0 6px">Virtual Histories</h3>
          <hr class="hr-dots" />
          <div id="virtual-history" class="post-body"></div>
        </article>
      </section>

      <!-- Footer include -->
      <div id="footer-include" data-src="partials/footer.html"></div>
    </main>
  </div>

  <script>
    (async function(){
      const grid = document.getElementById('posts-grid');
      try{
        const res = await fetch('posts/posts.json?nocache=' + Date.now());
        const posts = await res.json();
        posts.sort((a,b)=> new Date(b.date) - new Date(a.date));
        const fmt = iso => new Date(iso).toLocaleDateString(undefined,{year:'numeric', month:'short', day:'numeric'});
        grid.innerHTML = posts.slice(0, 9).map(p => `
          <article class="post-card" ${p.cardImage ? `style="--card-img: url('${p.cardImage}');"` : ''}>
            <h3><a href="${p.url}">${p.titleHtml || p.title}</a></h3>
            <time class="post-time" datetime="${p.date}">${fmt(p.date)}</time>
            <p class="post-meta">${p.category}${p.subcategory ? ' • ' + p.subcategory : ''}</p>
            ${p.excerpt ? `<p class="post-body">${p.excerpt}</p>` : ''}
          </article>
        `).join('');
        grid.querySelectorAll('.post-card a').forEach(a=>{
          const raw = a.getAttribute('href');
          a.setAttribute('href', `post.html?u=${encodeURIComponent(raw)}`);
        });
        if (window.MathJax?.typeset) MathJax.typeset();
      }catch(e){
        grid.innerHTML = '<p class="post-body" style="color:#cfcac3">Could not load posts.</p>';
      }
    })();
  </script>

  <script>
  /* =====================================================
     CONTENT BOXES TO FILL (edit these only)
     ===================================================== */
    const LEFT_TABS = [
      // ⇩ Replace/add as many labels as you like
      "index.htm","guestbook.cgi","/blinkies/","frames.html",
      "nav_old.css","under_construction.gif","counter: 000123",
      "sitering: surreal","webcam.jpg","marquee.txt","midis/","/cgi-bin/",
      "portal.htm","topsites #42","my-links.html","splash.swf"
    ];
  
    const RIGHT_LOADING_COUNT = 36; // how many “Loading” rows to reveal
  
    /* =====================================================
       INITIAL RENDER (create nodes but keep them hidden)
       ===================================================== */
    const left = document.getElementById('leftTabs');
    const right = document.getElementById('rightLoading');
  
    if (left && right){ // only run on the homepage
      const leftNodes = LEFT_TABS.map(label => {
        const el = document.createElement('div');
        el.className = 'tab';
        el.textContent = label;
        el.style.visibility = 'hidden';
        left.appendChild(el);
        return el;
      });
  
      const rightNodes = Array.from({length: RIGHT_LOADING_COUNT}, () => {
        const el = document.createElement('div');
        el.className = 'loading-item';
        el.innerHTML = `Loading<span>…</span>`;
        el.style.visibility = 'hidden';
        right.appendChild(el);
        return el;
      });
  
      /* =====================================================
         SCROLL PROGRESS → reveal counts left/up and right/down
         ===================================================== */
      const section = document.getElementById('interlude');
      function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }
      function getProgress(){
        const rect = section.getBoundingClientRect();
        const vh = window.innerHeight || document.documentElement.clientHeight;
        const travel = rect.height + vh; // start/stop gently
        const y = clamp((vh/2 - rect.top) / travel, 0, 1);
        return y;
      }
      function render(){
        const p = getProgress();
        const leftReveal = Math.floor(p * leftNodes.length);
        const rightReveal = Math.floor(p * rightNodes.length);
        leftNodes.forEach((el, i) => { el.style.visibility = (i < leftReveal) ? 'visible' : 'hidden'; });
        rightNodes.forEach((el, i) => { el.style.visibility = (i < rightReveal) ? 'visible' : 'hidden'; });
      }
      let ticking = false;
      window.addEventListener('scroll', () => {
        if (!ticking){ requestAnimationFrame(()=>{ render(); ticking=false; }); ticking = true; }
      }, {passive:true});
      window.addEventListener('resize', render);
      render();
    }
  
    /* =====================================================
       OPTIONAL: use a <video> instead of <img>
       -----------------------------------------
       1) Replace the <img id="centerMedia"> with:
          <video class="center-media" id="centerMedia" autoplay muted loop playsinline src="YOUR-MOVIE.mp4"></video>
       2) Done.
       ===================================================== */
  </script>

  
</body>
</html>
