/* === Fonts === */
@import url('https://fonts.googleapis.com/css2?family=Iceberg&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Zen+Tokyo+Zoo&display=swap');

/* === Theme tokens === */
:root{
  --bg:#0a0d1a;
  --panel:rgba(12,14,24,.20);
  --border:rgba(185,205,255,.14);
  --text:#e8ecf7;
  --muted:#a3a9ba;
  --accent:#9ec1ff;

  --font:"Iceberg",system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
  --maxw:1100px;
  --space:1.25rem;
}

/* === Base === */
*{box-sizing:border-box}
html{-webkit-text-size-adjust:100%;text-size-adjust:100%}
body{margin:0;color:var(--text);background:var(--bg);font:400 16px/1.65 var(--font);letter-spacing:.01em}
.container{width:min(100% - 2rem,var(--maxw));margin-inline:auto}
a{color:var(--accent);text-decoration:none}
a:hover{text-decoration:underline}
.muted{color:var(--muted)}

/* =========================
   Header (3 rows: title / blurb / menu)
   ========================= */
.site-header{
  display:grid;
  grid-template-columns: 1fr;
  grid-template-rows: auto auto auto;
  row-gap:.30rem;
  align-items:center;
  margin: calc(var(--space)*1.2) auto var(--space);
}

/* Title: one line, no layout shift */
.site-title{
  justify-self:start;
  display:block;
  margin:0;
  font-family:"Zen Tokyo Zoo",system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
  font-weight:400;
  color:#fff;
  font-size:clamp(1.6rem,3.6vw,2.2rem);
  line-height:1.1;
  letter-spacing:.003em;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
.site-title:visited{color:#fff}

/* Blurb: one line, muted, below title */
.site-header::after{
  content:"Hi, it’s Reza. I write about math, tech, and fiction.";
  grid-row:2;
  justify-self:start;
  color:var(--muted);
  font-weight:400;
  font-size:clamp(.95rem,1.8vw,1.05rem);
  line-height:1.1;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
/* Hide any legacy HTML blurb */
.site-intro{display:none !important}

/* Menu row */
.site-nav{
  grid-row:3;
  display:flex; flex-wrap:wrap; align-items:center;
  gap:.15rem .40rem;
}
.site-nav a{
  color:var(--muted);
  padding:.40rem .55rem;
  border:1px solid transparent;
}
.site-nav a:hover{color:#fff;border-color:var(--border);background:rgba(255,255,255,.06)}

/* Dropdown */
.nav-dropdown{position:relative;display:inline-block}
.nav-submenu--row{
  display:none; position:absolute; top:100%; left:0; z-index:10;
  min-width:12rem; background:rgba(8,10,18,.95);
  border:1px solid var(--border); border-radius:.5rem; padding:.4rem;
  box-shadow:0 16px 40px rgba(0,0,0,.6)
}
.nav-submenu--row a{display:block;padding:.5rem .6rem;font-size:1rem}
.nav-dropdown:hover .nav-submenu--row{display:flex;flex-direction:column}

/* About: subtle boxed pill (no decorative lines) */
.site-nav a[href$="about.html"]{
  font-family:"Zen Tokyo Zoo",var(--font);
  font-size:1.05rem;
  color:#fff;
  padding:.32rem .62rem;
  border:1px solid rgba(185,205,255,.28);
  background:transparent;
  box-shadow:none;
}

/* =======================
   Lists (home & categories)
   ======================= */
.list-heading{color:var(--muted);margin:0 0 .6rem;letter-spacing:.02em}
.posts-grid{display:grid;gap:1rem;grid-template-columns:repeat(auto-fill,minmax(300px,1fr))}
.post-card{
  background:var(--panel);
  border:1px solid var(--border);
  padding:1rem;
  border-radius:0;
  transition:transform .2s ease, box-shadow .2s ease, border-color .2s ease;
  text-decoration:none
}
.post-card:hover,.post-card:focus-within{
  transform:translateY(-2px);
  border-color:rgba(158,193,255,.30);
  box-shadow:0 16px 48px rgba(0,0,0,.55)
}
.post-title{margin:0 0 .35rem;font-weight:600;font-size:1.08rem;line-height:1.2}
.post-title a{color:var(--text)}
.post-time{color:var(--muted);font-size:.9em;display:block}
.post-meta{color:var(--muted);margin:.35rem 0 0;font-size:.92em}
.post-card *{word-break:normal;overflow-wrap:anywhere}

/* =================
   Article page grid
   ================= */
.page-main{width:min(100% - 2rem,var(--maxw));margin-inline:auto}
article.post-card{display:block}
.post-body{font-size:1.02rem}
.post-body p{margin:.9rem 0;text-indent:.8em}
.post-body p:first-of-type,.post-body h2 + p,.post-body h3 + p{text-indent:0}

/* two-column layout inside the article border (no overlap) */
.post-card.post-layout{
  display:grid;
  grid-template-columns:minmax(0,1fr) minmax(220px,300px);
  gap:1.25rem;
}

/* Blockquotes */
.post-body blockquote{
  margin:1.25rem 0;
  padding:.7rem .95rem 1rem 1rem;
  background:rgba(12,14,24,.18);
  border:1px solid var(--border);
  position:relative;
  border-left:4px solid rgba(158,193,255,.35)
}
.post-body blockquote::before,
.post-body blockquote::after{
  position:absolute;
  font-size:2.6rem; line-height:1;
  color:rgba(158,193,255,.35);
  font-family:Georgia,"Times New Roman",Times,serif
}
.post-body blockquote::before{content:"“";left:-.35rem;top:-.6rem}
.post-body blockquote::after{content:"”";right:.35rem;bottom:-.9rem}

/* Similar reads */
.similar-reads{margin-top:1.25rem;padding:.75rem;background:var(--panel);border:1px solid var(--border);border-radius:0}
.similar-reads h2{margin:0 0 .5rem 0;font-size:1.05rem;color:var(--muted)}
#similar-list{display:grid;gap:.5rem}
.similar-card{display:flex;flex-direction:column;gap:.1rem;padding:.55rem .6rem;border:1px solid var(--border);border-radius:0;background:rgba(10,12,22,.22);text-decoration:none;color:var(--text)}
.similar-card:hover{border-color:rgba(158,193,255,.35)}
.similar-card strong{font-size:.98rem}
.similar-card span{color:var(--muted);font-size:.88rem}

/* Footer */
.site-footer{margin:1.25rem auto}
.site-footer p{margin:0 0 .25rem 0;color:var(--muted)}
.site-footer small{color:var(--muted)}

/* Typewriter cursor */
.typer{border-right:2px solid rgba(255,255,255,.85)}
.caret-done{border-right-color:transparent}

/* === Global image caps === */
.post-body img,.figure img{
  display:block;max-width:680px;width:100%;height:auto;max-height:420px;
  object-fit:contain;margin:0 auto;border:1px solid var(--border);
  background:rgba(0,0,0,.25)
}
.figure--row{display:grid;grid-template-columns:1fr;gap:.75rem}
@media (min-width:820px){
  .figure--row{grid-template-columns:1fr 1fr}
  .figure--row img{max-height:360px}
}

/* === Home banner background === */
body.home{
  background:
    linear-gradient(180deg, rgba(10,13,26,.50), rgba(10,13,26,.50)),
    url("../img/banner.jpg") center / cover no-repeat fixed;
}

/* === Home layout: posts start below the fold, then features === */
body.home .home-posts{ margin-top:100vh; }   /* one screen before posts */
body.home .post-card{ background:rgba(12,14,24,.32); border-color:rgba(185,205,255,.20); }

/* reveal-on-scroll */
.reveal-card{ opacity:0; transform:translateY(22px);
  transition:opacity .5s ease-out, transform .5s ease-out; will-change:opacity,transform; }
.reveal-card.is-visible{ opacity:1; transform:translateY(0); }

/* Solid feature boxes */
.home-features{
  margin-top:1.75rem; display:grid; grid-template-columns:1fr; gap:1rem;
}
@media (min-width:900px){ .home-features{ grid-template-columns:1fr 1fr; } }
.feature-card{
  background:rgba(8,10,18,.98);
  border:1px solid rgba(185,205,255,.28);
  padding:1.1rem 1.2rem; border-radius:0;
}
.feature-title{ margin:0 0 .6rem 0; font-size:1.15rem; letter-spacing:.01em; color:var(--text); }
.feature-quote{ margin:0; min-height:3.25rem; }
.feature-body{ min-height:4.5rem; }


/* === Paper airplane scroll hint: curved, smoother, dotted trace === */
  html{ scroll-behavior: smooth; } /* nice-to-have */
  
  body.home .scroll-hint{
    position: fixed;
    top: clamp(110px, 18vh, 220px);   /* sits under the title area */
    left: clamp(24px, 10vw, 140px);   /* align with title column */
    z-index: 50;
    color: #ffffff;                   /* opaque plane */
    background: transparent;
    border: 0;
    padding: .25rem;
    cursor: pointer;
    opacity: 1;
    transition: opacity .25s ease, transform .25s ease;
    animation: tsi-plane-curve 2.8s cubic-bezier(.22,.61,.36,1) .3s 1 both;
  }
  body.home .scroll-hint:is(:hover,:focus-visible){
    transform: translateY(1px);
    outline: none;
  }
  body.home .scroll-hint.is-hidden{ display: none; }
  
  /* The dotted curve — drawn from top to near the posts */
  body.home .scroll-trace{
    position: fixed;
    top: clamp(110px, 18vh, 220px);
    left: clamp(24px, 10vw, 140px);
    width: 120px; height: 420px;
    z-index: 40;
    pointer-events: none;
    color: rgba(230,238,255,.95);
  }
  body.home .scroll-trace.is-hidden{ display: none; }
  body.home .scroll-trace path{
    fill: none;
    stroke: currentColor;
    stroke-width: 2;
    stroke-linecap: round;
    stroke-dasharray: 0 8;            /* dotted */
    opacity: .95;
    animation: tsi-trace-draw 2.2s ease-in-out .25s 1 both;
  }
  
  /* Smooth, curving flight that matches (roughly) the SVG curve */
  @keyframes tsi-plane-curve{
    0%   { transform: translate(0,0) rotate(8deg);   opacity: 1; }
    16%  { transform: translate(16px, 40px) rotate(5deg); }
    33%  { transform: translate(-6px, 110px) rotate(3deg); }
    50%  { transform: translate(12px, 190px) rotate(1deg); }
    66%  { transform: translate(-4px, 260px) rotate(.5deg); }
    83%  { transform: translate(8px, 320px) rotate(0deg); }
    100% { transform: translate(4px, 360px) rotate(0deg); opacity: 0; }
  }
  
  /* Draw the dotted trace from start to end */
  @keyframes tsi-trace-draw{
    from { stroke-dashoffset: 1200; }
    to   { stroke-dashoffset: 0; }
  }
  
  /* Reduce motion: no flying; subtle pulse + static dotted line */
  @media (prefers-reduced-motion: reduce){
    body.home .scroll-hint{ animation: none; }
    body.home .scroll-hint svg{ animation: tsi-pulse 1.8s ease-in-out infinite; }
    @keyframes tsi-pulse{ 0%,100%{opacity:.9;transform:none} 50%{opacity:1;transform:scale(1.06)} }
    body.home .scroll-trace path{ animation: none; opacity:.85; }
  }



  /* === Global: looping paper airplane scroll hint (all pages) === */
:root{
  /* Path is provided by JS; fallback here just in case */
  --flight-path: path("M 20 40 C 140 20, 100 140, 60 200 S 110 280, 40 340 S 110 420, 60 520");
  --flight-speed: 14s;
  --flight-color: rgba(242,245,255,0.98); /* milky */
}

html{ scroll-behavior:smooth; }

.flight-hint,
.flight-trace{
  position: fixed;
  top: 0; left: 0;
  pointer-events: auto;
  z-index: 60;
}

.flight-hint{
  width: 44px; height: 44px;          /* slightly larger */
  color: var(--flight-color);
  filter: drop-shadow(0 2px 6px rgba(0,0,0,.45));
  pointer-events: auto;
  cursor: default;
  /* Motion path flight */
  offset-path: var(--flight-path);
  offset-rotate: auto 90deg;           /* nose aligns with tangent */
  animation: plane-fly var(--flight-speed) cubic-bezier(.22,.61,.36,1) infinite;
}

.flight-hint svg{ width: 44px; height: 44px; display:block }

/* Dotted trace that “draws” behind the plane */
.flight-trace{
  width: 100vw; height: 100vh; z-index: 50; pointer-events:none;
}
.flight-trace svg{ width: 100%; height: 100%; }
.flight-trace path{
  fill: none;
  stroke: var(--flight-color);
  stroke-width: 2;
  stroke-linecap: round;
  stroke-dasharray: 0 9;              /* dotted look */
  opacity: .9;
  /* Draw the path repeatedly to feel alive */
  animation: trace-draw calc(var(--flight-speed) * .75) ease-in-out infinite;
}

/* Fade-out when near bottom (JS adds .flight-done) */
.flight-done .flight-hint,
.flight-done .flight-trace{
  animation-play-state: paused;
  opacity: 0;
  transition: opacity .7s ease;
  pointer-events: none;
}

/* Respect Reduce Motion */
@media (prefers-reduced-motion: reduce){
  .flight-hint{ animation:none; offset-path:none; position:fixed; top:10vh; left:10vw; }
  .flight-trace path{ animation:none; opacity:.75 }
}

/* Keyframes */
@keyframes plane-fly{
  0%   { offset-distance: 0%;   transform: translate(0,0) rotate(0deg); }
  22%  { offset-distance: 22%; }
  38%  { offset-distance: 38%; }
  55%  { offset-distance: 55%; }
  72%  { offset-distance: 72%; }
  88%  { offset-distance: 88%; }
  100% { offset-distance: 100%; }
}
@keyframes trace-draw{
  from { stroke-dashoffset: 1200; }
  to   { stroke-dashoffset: 0; }
}

